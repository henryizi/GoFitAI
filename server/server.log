--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-1.5-7b-hf
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
Server running on port 4000
Local IP: 192.168.0.100
Server URL: http://192.168.0.100:4000
Test API with: curl http://192.168.0.100:4000/api/test
{"level":30,"time":1756394012927,"pid":91629,"hostname":"MacBook-Air-126.local","req":{"id":1,"method":"GET","url":"/api/health","query":{},"params":{},"headers":{"host":"localhost:4000","user-agent":"curl/8.7.1","accept":"*/*"},"remoteAddress":"127.0.0.1","remotePort":57815},"res":{"statusCode":200,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"105","etag":"W/\"69-4aMXW5Wwnzvp0kKXimquXOsHQlE\""}},"responseTime":16,"msg":"request completed"}
{"level":30,"time":1756394022759,"pid":91629,"hostname":"MacBook-Air-126.local","req":{"id":2,"method":"POST","url":"/api/generate-workout-plan","query":{},"params":{},"headers":{"host":"localhost:4000","user-agent":"curl/8.7.1","accept":"*/*","content-type":"application/json","content-length":"95"},"remoteAddress":"127.0.0.1","remotePort":57818},"res":{"statusCode":200,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"10305","etag":"W/\"2841-p4hmKRvM0qJEDMq7P8h04Ji6hLE\""}},"responseTime":6,"msg":"request completed"}
[WORKOUT] Provider availability: { deepseek: true, defaultProvider: 'openrouter' }
[WORKOUT] Using DeepSeek as preferred provider
[AI] Trying provider: deepseek with model deepseek-chat
[AI] Calling deepseek API with model deepseek-chat
[AI] Request contains 1 messages
[AI] Using max_tokens: 4000
[2025-08-28T15:58:01.697Z] Checking if port 4000 is free...
[2025-08-28T15:58:01.700Z] Port 4000 is free
[2025-08-28T15:58:01.700Z] Starting server (attempt 1/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-1.5-7b-hf
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ [32m'deepseek'[39m, [32m'cloudflare'[39m, [32m'fallback'[39m ]
Default AI_PROVIDER: openrouter
Total providers available: [33m3[39m
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
Server running on port 4000
Local IP: 192.168.0.100
Server URL: http://192.168.0.100:4000
Test API with: curl http://192.168.0.100:4000/api/test
[2025-08-28T16:21:46.476Z] Server exited with code null and signal SIGKILL
[2025-08-28T16:21:46.476Z] Checking if port 4000 is free...
[2025-08-28T16:21:46.476Z] Port 4000 is free
[2025-08-28T16:21:46.477Z] Starting server (attempt 2/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-1.5-7b-hf
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ [32m'deepseek'[39m, [32m'cloudflare'[39m, [32m'fallback'[39m ]
Default AI_PROVIDER: openrouter
Total providers available: [33m3[39m
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
Server running on port 4000
Local IP: 192.168.0.100
Server URL: http://192.168.0.100:4000
Test API with: curl http://192.168.0.100:4000/api/test
[2025-08-29T05:19:47.257Z] Checking if port 4000 is free...
[2025-08-29T05:19:47.263Z] Port 4000 is free
[2025-08-29T05:19:47.264Z] Starting server (attempt 1/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
Server running on port 4000
Local IP: 192.168.0.100
Server URL: http://192.168.0.100:4000
Test API with: curl http://192.168.0.100:4000/api/test
[PROFILE GET] Getting profile for user: test123
[PROFILE GET] Error getting profile: {
  code: '22P02',
  details: null,
  hint: null,
  message: 'invalid input syntax for type uuid: "test123"'
}
[PROFILE GET] Error: invalid input syntax for type uuid: "test123"
{"level":30,"time":1756444803539,"pid":61489,"hostname":"MacBook-Air-126.local","req":{"id":1,"method":"GET","url":"/api/profile/test123","query":{},"params":{},"headers":{"host":"localhost:4000","user-agent":"curl/8.7.1","accept":"*/*"},"remoteAddress":"127.0.0.1","remotePort":52201},"res":{"statusCode":500,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"75","etag":"W/\"4b-pH5jvzTqdtDem8uKUGwX4hmosTI\""}},"err":{"type":"Error","message":"failed with status code 500","stack":"Error: failed with status code 500\n    at onResFinished (/Users/ngkwanho/Desktop/SnapBodyAI/server/node_modules/pino-http/logger.js:114:39)\n    at ServerResponse.onResponseComplete (/Users/ngkwanho/Desktop/SnapBodyAI/server/node_modules/pino-http/logger.js:177:14)\n    at ServerResponse.emit (node:events:530:35)\n    at onFinish (node:_http_outgoing:1081:10)\n    at callback (node:internal/streams/writable:766:21)\n    at afterWrite (node:internal/streams/writable:710:5)\n    at afterWriteTick (node:internal/streams/writable:696:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:89:21)"},"responseTime":1061,"msg":"request errored"}
[2025-08-29T05:30:51.211Z] Checking if port 4000 is free...
[2025-08-29T05:30:51.215Z] Port 4000 is free
[2025-08-29T05:30:51.215Z] Starting server (attempt 1/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:30:51.403Z] Server exited with code 1 and signal null
[2025-08-29T05:30:51.403Z] Waiting 2000ms before restarting server...
[2025-08-29T05:30:53.404Z] Checking if port 4000 is free...
[2025-08-29T05:30:53.405Z] Port 4000 is free
[2025-08-29T05:30:53.405Z] Starting server (attempt 2/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:30:53.555Z] Server exited with code 1 and signal null
[2025-08-29T05:30:53.555Z] Waiting 2000ms before restarting server...
[2025-08-29T05:30:55.556Z] Checking if port 4000 is free...
[2025-08-29T05:30:55.556Z] Port 4000 is free
[2025-08-29T05:30:55.556Z] Starting server (attempt 3/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:30:55.675Z] Server exited with code 1 and signal null
[2025-08-29T05:30:55.675Z] Waiting 2000ms before restarting server...
[2025-08-29T05:30:57.676Z] Checking if port 4000 is free...
[2025-08-29T05:30:57.677Z] Port 4000 is free
[2025-08-29T05:30:57.677Z] Starting server (attempt 4/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:30:57.827Z] Server exited with code 1 and signal null
[2025-08-29T05:30:57.827Z] Waiting 2000ms before restarting server...
[2025-08-29T05:30:59.827Z] Checking if port 4000 is free...
[2025-08-29T05:30:59.828Z] Port 4000 is free
[2025-08-29T05:30:59.828Z] Starting server (attempt 5/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:31:00.086Z] Server exited with code 1 and signal null
[2025-08-29T05:31:00.086Z] Waiting 2000ms before restarting server...
[2025-08-29T05:31:02.086Z] Checking if port 4000 is free...
[2025-08-29T05:31:02.087Z] Port 4000 is free
[2025-08-29T05:31:02.087Z] Starting server (attempt 6/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:31:02.190Z] Server exited with code 1 and signal null
[2025-08-29T05:31:02.190Z] Waiting 2000ms before restarting server...
[2025-08-29T05:31:04.191Z] Checking if port 4000 is free...
[2025-08-29T05:31:04.191Z] Port 4000 is free
[2025-08-29T05:31:04.192Z] Starting server (attempt 7/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:31:04.301Z] Server exited with code 1 and signal null
[2025-08-29T05:31:04.301Z] Waiting 2000ms before restarting server...
[2025-08-29T05:31:06.301Z] Checking if port 4000 is free...
[2025-08-29T05:31:06.302Z] Port 4000 is free
[2025-08-29T05:31:06.302Z] Starting server (attempt 8/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:31:06.410Z] Server exited with code 1 and signal null
[2025-08-29T05:31:06.410Z] Waiting 2000ms before restarting server...
[2025-08-29T05:31:08.410Z] Checking if port 4000 is free...
[2025-08-29T05:31:08.413Z] Port 4000 is free
[2025-08-29T05:31:08.413Z] Starting server (attempt 9/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:31:08.576Z] Server exited with code 1 and signal null
[2025-08-29T05:31:08.576Z] Waiting 2000ms before restarting server...
[2025-08-29T05:31:10.577Z] Checking if port 4000 is free...
[2025-08-29T05:31:10.577Z] Port 4000 is free
[2025-08-29T05:31:10.577Z] Starting server (attempt 10/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
[SERVER] Server error: Error: listen EADDRINUSE: address already in use 0.0.0.0:4000
    at Server.setupListenHandle [as _listen2] (node:net:1937:16)
    at listenInCluster (node:net:1994:12)
    at node:net:2203:7
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '0.0.0.0',
  port: 4000
}
[SERVER] Port 4000 is already in use
[2025-08-29T05:31:10.678Z] Server exited with code 1 and signal null
[2025-08-29T05:31:10.678Z] Waiting 2000ms before restarting server...
[2025-08-29T05:31:12.679Z] Server has restarted 10 times. Giving up.
[2025-08-29T05:32:09.774Z] Received SIGTERM. Shutting down gracefully...
[2025-08-29T05:32:09.775Z] Terminating server process...
[SHUTDOWN] Received SIGTERM. Shutting down gracefully...
[2025-08-29T05:32:09.778Z] Server exited with code 0 and signal null
[2025-08-29T05:32:09.778Z] Checking if port 4000 is free...
[2025-08-29T05:32:09.778Z] Port 4000 is free
[2025-08-29T05:32:09.778Z] Starting server (attempt 2/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[2025-08-29T05:32:09.815Z] No processes found on port 4000
[2025-08-29T05:32:17.175Z] Checking if port 4000 is free...
[2025-08-29T05:32:17.179Z] Port 4000 is free
[2025-08-29T05:32:17.180Z] Starting server (attempt 1/10)...
--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] CF_VISION_MODEL env var: @cf/llava-hf/llava-1.5-7b-hf
[VISION MODEL DEBUG] Resolved model: @cf/llava-hf/llava-1.5-7b-hf
[CF VISION] Optimized VisionService initialized
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'cloudflare', 'fallback' ]
Default AI_PROVIDER: openrouter
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- cloudflare: ENABLED (@cf/llava-hf/llava-1.5-7b-hf)
- fallback: ENABLED (rule-based)
========================
Server running on port 4000
Local IP: 192.168.0.100
Server URL: http://192.168.0.100:4000
Test API with: curl http://192.168.0.100:4000/api/test
[2025-08-29T05:34:47.136Z] Test endpoint called
{"level":30,"time":1756445687138,"pid":63123,"hostname":"MacBook-Air-126.local","req":{"id":1,"method":"GET","url":"/api/test","query":{},"params":{},"headers":{"host":"localhost:4000","user-agent":"curl/8.7.1","accept":"*/*"},"remoteAddress":"127.0.0.1","remotePort":52662},"res":{"statusCode":200,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"284","etag":"W/\"11c-iUb5pVXMMh63vO0YUyDHAQ5Iffo\""}},"responseTime":3,"msg":"request completed"}
[2025-08-29T05:36:12.434Z] Test endpoint called
{"level":30,"time":1756445772434,"pid":63123,"hostname":"MacBook-Air-126.local","req":{"id":2,"method":"GET","url":"/api/test","query":{},"params":{},"headers":{"host":"localhost:4000","user-agent":"curl/8.7.1","accept":"*/*"},"remoteAddress":"127.0.0.1","remotePort":52703},"res":{"statusCode":200,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"284","etag":"W/\"11c-Slu7ceUN1MmMx6k4fkoo+oAN1N4\""}},"responseTime":1,"msg":"request completed"}
[PROFILE GET] Getting profile for user: test123
[PROFILE GET] Error getting profile: {
  code: '22P02',
  details: null,
  hint: null,
  message: 'invalid input syntax for type uuid: "test123"'
}
[PROFILE GET] Error: invalid input syntax for type uuid: "test123"
{"level":30,"time":1756446330327,"pid":63123,"hostname":"MacBook-Air-126.local","req":{"id":3,"method":"GET","url":"/api/profile/test123","query":{},"params":{},"headers":{"host":"192.168.0.100:4000","user-agent":"curl/8.7.1","accept":"*/*"},"remoteAddress":"192.168.0.100","remotePort":52910},"res":{"statusCode":500,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"75","etag":"W/\"4b-pH5jvzTqdtDem8uKUGwX4hmosTI\""}},"err":{"type":"Error","message":"failed with status code 500","stack":"Error: failed with status code 500\n    at onResFinished (/Users/ngkwanho/Desktop/SnapBodyAI/server/node_modules/pino-http/logger.js:114:39)\n    at ServerResponse.onResponseComplete (/Users/ngkwanho/Desktop/SnapBodyAI/server/node_modules/pino-http/logger.js:177:14)\n    at ServerResponse.emit (node:events:530:35)\n    at onFinish (node:_http_outgoing:1081:10)\n    at callback (node:internal/streams/writable:766:21)\n    at afterWrite (node:internal/streams/writable:710:5)\n    at afterWriteTick (node:internal/streams/writable:696:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:89:21)"},"responseTime":1059,"msg":"request errored"}
[PROFILE UPDATE] Updating profile for user: test123
[PROFILE UPDATE] Updates: { training_level: 'beginner' }
[PROFILE UPDATE] Error updating profile: {
  code: '22P02',
  details: null,
  hint: null,
  message: 'invalid input syntax for type uuid: "test123"'
}
[PROFILE UPDATE] Error: invalid input syntax for type uuid: "test123"
{"level":30,"time":1756446340001,"pid":63123,"hostname":"MacBook-Air-126.local","req":{"id":4,"method":"PUT","url":"/api/profile","query":{},"params":{},"headers":{"host":"192.168.0.100:4000","user-agent":"curl/8.7.1","accept":"*/*","content-type":"application/json","content-length":"60"},"remoteAddress":"192.168.0.100","remotePort":52918},"res":{"statusCode":500,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"75","etag":"W/\"4b-pH5jvzTqdtDem8uKUGwX4hmosTI\""}},"err":{"type":"Error","message":"failed with status code 500","stack":"Error: failed with status code 500\n    at onResFinished (/Users/ngkwanho/Desktop/SnapBodyAI/server/node_modules/pino-http/logger.js:114:39)\n    at ServerResponse.onResponseComplete (/Users/ngkwanho/Desktop/SnapBodyAI/server/node_modules/pino-http/logger.js:177:14)\n    at ServerResponse.emit (node:events:530:35)\n    at onFinish (node:_http_outgoing:1081:10)\n    at callback (node:internal/streams/writable:766:21)\n    at afterWrite (node:internal/streams/writable:710:5)\n    at afterWriteTick (node:internal/streams/writable:696:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:89:21)"},"responseTime":727,"msg":"request errored"}
