--- SERVER RESTARTED ---
--- Code version: 2.2 ---
[GEMINI VISION] Enhanced GeminiVisionService initialized
[GEMINI VISION] Using model: gemini-2.0-flash-exp
[GEMINI VISION] API Key configured: ✅ Yes
[GEMINI VISION] Enhanced GeminiVisionService initialized
[GEMINI VISION] Using model: gemini-2.0-flash-exp
[GEMINI VISION] API Key configured: ✅ Yes
=== API CONFIGURATION ===
DeepSeek-only mode: DISABLED
Strict mode (effective): DISABLED
Available AI Providers: [ 'deepseek', 'gemini', 'fallback' ]
Default AI_PROVIDER: gemini
Total providers available: 3
- deepseek: ENABLED (deepseek-chat)
- gemini: ENABLED (gemini-2.0-flash-exp)
- fallback: ENABLED (rule-based)
========================
Server running on port 4000
Local IP: 192.168.0.100
Server URL: http://192.168.0.100:4000
Test API with: curl http://192.168.0.100:4000/api/test
[FOOD ANALYZE] Received food analysis request using Gemini only
[FOOD ANALYZE] Request details: { hasFile: false, hasDescription: true, fileInfo: null }
[FOOD ANALYZE] Processing text description with Gemini
{"level":30,"time":1756625794453,"pid":66829,"hostname":"MacBook-Air-126.local","req":{"id":1,"method":"POST","url":"/api/analyze-food","query":{},"params":{},"headers":{"host":"localhost:4000","user-agent":"curl/8.7.1","accept":"*/*","content-type":"application/json","content-length":"44"},"remoteAddress":"127.0.0.1","remotePort":50291},"res":{"statusCode":200,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"767","etag":"W/\"2ff-N47fEp7yt8+hsJ3XO0FlEYEV3BE\""}},"responseTime":4041,"msg":"request completed"}
[MULTER] Uploaded file details: {
  originalname: 'test-food-image.jpg',
  mimetype: 'image/jpeg',
  size: undefined
}
[MULTER] File accepted: test-food-image.jpg MIME: image/jpeg
[FOOD ANALYZE] Received food analysis request using Gemini only
[FOOD ANALYZE] Request details: {
  hasFile: true,
  hasDescription: false,
  fileInfo: {
    originalname: 'test-food-image.jpg',
    filename: '6a49fc6b6f14889be781cf47911c6312',
    mimetype: 'image/jpeg',
    size: 25043
  }
}
[FOOD ANALYZE] Processing uploaded file
[FOOD ANALYZE] Processed image, mimeType: image/jpeg
[FOOD ANALYZE] Using Gemini Vision API for image analysis
[GEMINI VISION] Analyzing food image with Gemini
[GEMINI VISION] Starting image analysis with Gemini Vision API
[GEMINI VISION] ✅ Analysis completed in 3962ms
[FOOD ANALYZE] Gemini vision analysis successful
[FOOD ANALYZE] Vision analysis successful
[FOOD ANALYZE] Calling Gemini exclusively for nutrition analysis
[FOOD ANALYZE] Gemini nutrition analysis completed successfully (no DeepSeek fallback)
{"level":30,"time":1756625810626,"pid":66829,"hostname":"MacBook-Air-126.local","req":{"id":2,"method":"POST","url":"/api/analyze-food","query":{},"params":{},"headers":{"host":"localhost:4000","user-agent":"curl/8.7.1","accept":"*/*","content-length":"25257","content-type":"multipart/form-data; boundary=------------------------c6TH6Mfkhz69F4IXIPPG2G"},"remoteAddress":"127.0.0.1","remotePort":50294},"res":{"statusCode":200,"headers":{"cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"SAMEORIGIN","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","access-control-allow-origin":"*","access-control-allow-credentials":"true","access-control-expose-headers":"Content-Length,Content-Type","content-type":"application/json; charset=utf-8","content-length":"698","etag":"W/\"2ba-2VYuEUY3Xi9GdFaQP56SYIjnZBs\""}},"responseTime":6207,"msg":"request completed"}
